<script setup lang="ts">
import { onBeforeMount, onMounted } from 'vue'


if (import.meta.server) {
    console.log(`\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔵 [S5] INDEX.VUE SETUP (SERVER) — Выполнение setup страницы на сервере
   💡 Получение данных (useFetch), формирование HTML и <head>
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n`)
} else {
    console.log(`\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🟢 [C8] INDEX.VUE SETUP (CLIENT) — Выполнение setup страницы при гидрации
   💡 Активация реактивности, данные из payload (без повторного запроса)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n`)
}

// На сервере: выполнится и положит данные в payload
// На клиенте при первом заходе: возьмёт из payload (без второго запроса)
const { data: settings } = await useFetch('/api/site/settings')

onBeforeMount(() => {
  console.log(`\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🟢 [C10] INDEX.VUE onBeforeMount — Перед монтированием DOM страницы
   💡 Подготовка действий до доступа к DOM элементам страницы
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n`)
})

onMounted(() => {
  console.log(`\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🟢 [C12] INDEX.VUE onMounted — После монтирования страницы
   💡 Инициализация только-клиентских виджетов (карты, чарты и т.п.)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n`)
})
</script>


<template>
  <div class="stack">
    <h1>{{ settings?.title }}</h1>
    <p><NuxtLink to="/delayed">Go to /delayed</NuxtLink></p>
    <p><NuxtLink to="/spa/demo">Go to SPA island (/spa/demo)</NuxtLink></p>
  </div>
</template>


<style scoped>
.stack { display: grid; gap: .75rem; }
</style>